<img align="right" src="https://billrocha.netlify.app/Handmade.png" alt="Hand Made">

# astro-sw
Astro Service Worker in vanilla Javascript

### SAMPLE SERVICE WORKER !!
	
Create a directory to contain your Service Worker files at path: "./src/sw/".
	
The Astro-sw plugin will load and parse the contents of files contained in this directory to "./public/sw.js" during development mode and to the path "./dist/sw.js" in build.
	
Some parameters can be configured in your application's "astro.config":
	
--- astro.config.mjs ----
```
    import { defineConfig } from 'astro/config';
    import sw from 'astro-sw'
	
    const sw_config = {
		dir: './src/sw', 					// path of files to be concatenated (default: './src/sw')
			order: [						// optional concatenation ordering (files with ".js" extension only)
				'cache', 
				'push/click.js',
				'fetch',
				// etc... 
			],	
			filename: 'sw.js', 				// final filename (default: 'sw.js')
			auto: true, 					// generate cache version automatically (default: true)
			obfuscate: false, 				// build only: add obfuscation (default: false)
			uglify: false, 					// build only: add uglify (default: false)
	  }

	export default defineConfig({
		integrations: [
			// ... others integrations
			
			sw(sw_config), 				// or just sw(), if you want to use the defaults
			
			// ... others integrations
		]
	});
```

If no configuration is added, the default values will be assumed.

If Astro-sw does not find the ```./src/sw``` directory (configurable), it will load a "sample.js" file with the basics of a service worker: cache + fetch.

### ASSETS
	
An ASSETS constant is added by Astro-sw to list the files to be cached in the client's browser. In "dev" mode this array will be empty.
	
If you need to add files to the list, use "push" on this array:
	
```ASSETS.push( 'file' );```
	
Any file accessible by the browser in "dev" mode can be added. Your service worker must use ASSETS to populate the browser's cache.
	
In "production" mode, after the build, ASSETS will be AUTOMATICALLY populated with the files generated by Astro Builder in the ```./dist``` folder.

### TODO:

In the next versions support for Workbox will be added.

---

## License

[MIT](https://mit-license.org) Â© [Bill Rocha](https://billrocha.netlify.com)